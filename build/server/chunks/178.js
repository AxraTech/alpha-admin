"use strict";exports.id=178,exports.ids=[178],exports.modules={5330:(e,l,t)=>{t.d(l,{Z:()=>i});var s=t(10326);t(17577);var a=t(38506),r=t(76865);let i=()=>{let{globalMsg:e,setGlobalMsg:l}=(0,r.q)();return s.jsx("div",{children:s.jsx(a.Z,{anchorOrigin:{horizontal:"center",vertical:"top"},open:!!e,autoHideDuration:3e3,onClose:()=>l(null),message:e})})}},20802:(e,l,t)=>{t.d(l,{Q:()=>s});let s=e=>e.split(/\s/).reduce((e,l)=>e+=l.slice(0,1),"")},70178:(e,l,t)=>{t.d(l,{Z:()=>O});var s=t(10326),a=t(17577),r=t(35047),i=t(87700),n=t(19518),o=t(84187),d=t(48260),c=t(95684),u=t(78077),m=t(25609),x=t(19074),g=t(53913),p=t(918),h=t(37841),j=t(56390),f=t(99207),v=t(74723),_=t(18753),S=t(84875),b=t(24443),w=t(5330),Z=t(76865),N=t(29084),y=t(36238);let C=e=>{let{setGlobalMsg:l}=(0,Z.q)(),{open:t,handleClose:r,discountData:n,loading:o,setLoading:c,setData:C}=e,[P]=(0,_.D)(b.dn),[D,M]=(0,a.useState)(),[F,R]=(0,a.useState)(),{data:k}=(0,S.kJ)(N.pR),[z,V]=(0,a.useState)("");(0,a.useRef)(null);let{control:q,reset:T,handleSubmit:I,formState:{errors:E}}=(0,v.cI)({defaultValues:{min_order:"",discounted_value:"",customer_type:""}});(0,a.useEffect)(()=>{n&&T({min_order:n.min_order,discounted_value:n.discounted_value,customer_type:n.customer_type})},[n,T]);let O=async e=>{try{c(!0);let t=await P({variables:{id:n.id,data:{min_order:Number(e.min_order),customer_type:F,discounted_value:Number(e.discounted_value),product_id:n.product_id}}});c(!1),C(e=>e.map(e=>e.id===n?.id?{...e,...t.data.update_product_discounts_by_pk}:e)),G(),l("âœ… Product discount has been updated")}catch(e){console.log("Error ",e)}},G=()=>{r(),T({title:"",description:""}),V("")};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(x.ZP,{open:t,anchor:"right",variant:"temporary",onClose:G,ModalProps:{keepMounted:!0},sx:{"& .MuiDrawer-paper":{width:{xs:300,sm:400}}},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between pli-5 plb-4",children:[s.jsx(m.Z,{variant:"h5",children:"Edit Discount"}),s.jsx(d.Z,{size:"small",onClick:G,children:s.jsx("i",{className:"ri-close-line text-2xl"})})]}),s.jsx(f.Z,{}),s.jsx("div",{className:"p-5",children:(0,s.jsxs)("form",{onSubmit:I(e=>O(e)),className:"flex flex-col gap-5",children:[s.jsx(v.Qr,{name:"min_order",control:q,rules:{required:!0},render:({field:e})=>s.jsx(u.Z,{...e,fullWidth:!0,type:"number",label:"Minimal Order",placeholder:"",...E.min_order&&{error:!0,helperText:"This field is required."}})}),s.jsx(v.Qr,{name:"discounted_value",control:q,rules:{required:!0},render:({field:e})=>s.jsx(u.Z,{...e,fullWidth:!0,type:"number",label:"Discounted Value",placeholder:"",...E.discounted_value&&{error:!0,helperText:"This field is required."}})}),(0,s.jsxs)(g.Z,{fullWidth:!0,children:[s.jsx(p.Z,{children:"Select User Role"}),s.jsx(j.Z,{label:"Select Vendor",value:F,onChange:e=>R(e.target.value),children:k?.user_roles?.map((e,l)=>s.jsx(h.Z,{value:e?.role_name,children:e?.role_name},l))}),s.jsx(y.Z,{sx:{color:"red"},children:E?.role_name})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx(i.Z,{variant:"contained",type:"submit",loading:o,children:"Update"}),s.jsx(i.Z,{variant:"outlined",color:"error",type:"reset",onClick:G,children:"Discard"})]})]})})]}),s.jsx(w.Z,{})]})};var P=t(5606),D=t(11798),M=t(86508),F=t(48029),R=t.n(F),k=t(92474),z=t(4099);t(40529),t(20802);var V=t(89307),q=t.n(V);let T=(e,l,t,s)=>{let a=(0,P.O4)(e.getValue(l),t);return s({itemRank:a}),a.passed},I=({value:e,onChange:l,debounce:t=500,...r})=>{let[i,n]=(0,a.useState)(e);return(0,a.useEffect)(()=>{n(e)},[e]),(0,a.useEffect)(()=>{let e=setTimeout(()=>{l(i)},t);return()=>clearTimeout(e)},[i]),s.jsx(u.Z,{...r,value:i,onChange:e=>n(e.target.value),size:"small"})},E=(0,D.Cl)(),O=({productData:e})=>{let{data:l}=(0,S.kJ)(N.ef,{variables:{product_id:e.id},fetchPolicy:"network-only"}),{data:t}=(0,S.kJ)(N.DF),{setGlobalMsg:u}=(0,Z.q)(),[x,g]=(0,a.useState)(""),[p,h]=(0,a.useState)(!1),[j,f]=(0,a.useState)({}),[v,y]=(0,a.useState)(l.product_discounts),[P,F]=(0,a.useState)(),[V,O]=(0,a.useState)(v),[G,H]=(0,a.useState)(""),[J,L]=(0,a.useState)(!1),[Q]=(0,_.D)(b.Qm),U=(e,l,t)=>({children:e,color:l,variant:t}),{lang:W}=(0,r.useParams)();console.log("data -----",v);let $=(0,a.useMemo)(()=>[E.accessor("id",{header:"#",cell:({row:e})=>s.jsx(m.Z,{color:"primary",children:`${e.original.id.substring(0,10)}`})}),E.accessor("min_order ",{header:"Minimal Order",cell:({row:e})=>s.jsx("div",{className:"flex items-center gap-3",children:s.jsx("div",{className:"flex flex-col",children:s.jsx(m.Z,{className:"font-medium",color:"text.primary",children:e.original.min_order})})})}),E.accessor("customer_type ",{header:"Customer Type",cell:({row:e})=>s.jsx("div",{className:"flex items-center gap-3",children:s.jsx("div",{className:"flex flex-col",children:s.jsx(m.Z,{className:"font-medium",color:"text.primary",children:e.original.customer_type})})})}),E.accessor("discounted_value",{header:"Discounted Value",cell:({row:e})=>s.jsx(m.Z,{children:`${null!==e.original.discounted_value?e.original.discounted_value.toLocaleString():"-"}`})}),E.accessor("created_at",{header:"Date",cell:({row:e})=>s.jsx(m.Z,{children:e.original.created_at.substring(0,10)})}),E.accessor("action",{header:"Action",cell:({row:e})=>(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx(z.Z,{element:i.Z,elementProps:U(s.jsx("i",{className:"ri-delete-bin-7-line text-[22px] text-red-500"}),"error",""),dialog:k.Z,dialogProps:{type:"deleteProductDiscount"},dataId:e.original.id,setData:y,data:v}),s.jsx(d.Z,{onClick:()=>{F(e.original),L(!0)},children:s.jsx("i",{className:"ri-pencil-line"})})]}),enableSorting:!1})],[v,V]),A=(0,M.b7)({data:V,columns:$,filterFns:{fuzzy:T},state:{rowSelection:j,globalFilter:G},initialState:{pagination:{pageSize:10}},enableRowSelection:!0,globalFilterFn:T,onRowSelectionChange:f,getCoreRowModel:(0,D.sC)(),onGlobalFilterChange:H,getFilteredRowModel:(0,D.vL)(),getSortedRowModel:(0,D.tj)(),getPaginationRowModel:(0,D.G_)(),getFacetedRowModel:(0,D.o6)(),getFacetedUniqueValues:(0,D.JG)(),getFacetedMinMaxValues:(0,D.HO)()});return(0,a.useEffect)(()=>{O(v?.filter(e=>!x||e.status.toLowerCase().replace(/\s+/g,"-")===x))},[x,v,O]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.Z,{children:[s.jsx(o.Z,{className:"flex justify-between gap-4 flex-wrap flex-col sm:flex-row items-center",children:s.jsx("div",{className:"flex flex-col sm:flex-row max-sm:is-full items-center gap-4",children:s.jsx(I,{value:G??"",onChange:e=>H(String(e)),placeholder:"Search Product Discount",className:"max-sm:is-full min-is-[200px]"})})}),s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:q().table,children:[s.jsx("thead",{children:A.getHeaderGroups().map(e=>s.jsx("tr",{children:e.headers.map(e=>s.jsx("th",{children:e.isPlaceholder?null:s.jsx(s.Fragment,{children:(0,s.jsxs)("div",{className:R()({"flex items-center":e.column.getIsSorted(),"cursor-pointer select-none":e.column.getCanSort()}),onClick:e.column.getToggleSortingHandler(),children:[(0,M.ie)(e.column.columnDef.header,e.getContext()),{asc:s.jsx("i",{className:"ri-arrow-up-s-line text-xl"}),desc:s.jsx("i",{className:"ri-arrow-down-s-line text-xl"})}[e.column.getIsSorted()]??null]})})},e.id))},e.id))}),0===A.getFilteredRowModel().rows.length?s.jsx("tbody",{children:s.jsx("tr",{children:s.jsx("td",{colSpan:A.getVisibleFlatColumns().length,className:"text-center",children:"No data available"})})}):s.jsx("tbody",{children:A.getRowModel().rows.slice(0,A.getState().pagination.pageSize).map(e=>s.jsx("tr",{className:R()({selected:e.getIsSelected()}),children:e.getVisibleCells().map(e=>s.jsx("td",{children:(0,M.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id))})]})}),s.jsx(c.Z,{rowsPerPageOptions:[10,25,50],component:"div",className:"border-bs",count:A.getFilteredRowModel().rows.length,rowsPerPage:A.getState().pagination.pageSize,page:A.getState().pagination.pageIndex,SelectProps:{inputProps:{"aria-label":"rows per page"}},onPageChange:(e,l)=>{A.setPageIndex(l)},onRowsPerPageChange:e=>A.setPageSize(Number(e.target.value))})]}),s.jsx(w.Z,{}),s.jsx(C,{open:J,discountData:P,setData:y,loading:p,setLoading:h,handleClose:()=>L(!J)})]})}}};