"use strict";exports.id=3656,exports.ids=[3656],exports.modules={91347:(e,l,r)=>{r.d(l,{Z:()=>i});var t=r(27486);r(618);var s=r(27319),a=r(22405);let i=()=>{let{globalMsg:e,setGlobalMsg:l}=(0,a.q)();return t.jsx("div",{children:t.jsx(s.Z,{anchorOrigin:{horizontal:"center",vertical:"top"},open:!!e,autoHideDuration:3e3,onClose:()=>l(null),message:e})})}},26808:(e,l,r)=>{r.d(l,{Q:()=>t});let t=e=>e.split(/\s/).reduce((e,l)=>e+=l.slice(0,1),"")},88682:(e,l,r)=>{r.d(l,{Z:()=>S});var t=r(27486),s=r(618),a=r(12964),i=r(20700),n=r(39800),d=r(44182),o=r(9594),c=r(50822),u=r(23467),m=r(95727),x=r(30785),h=r(72660),p=r(22405),g=r(91347),j=r(66718),_=r(25009),f=r(83398),v=r(45882),Z=r(38532),b=r(58894);let S=e=>{let{setGlobalMsg:l}=(0,p.q)(),{open:r,handleClose:S,data:N,productId:y,loading:w,setLoading:C,setData:D}=e,[P]=(0,f.D)(j.Lh),[M,R]=(0,s.useState)(""),{data:F}=(0,v.kJ)(_.pR),[k,q]=(0,s.useState)(null),[T,V]=(0,s.useState)(!1);(0,s.useRef)(null);let{control:z,reset:I,handleSubmit:E,formState:{errors:O}}=(0,b.cI)({defaultValues:{min_order:"",customer_type:"",discounted_value:"",product_id:""}}),L=async e=>{if(!M){V(!0);return}try{C(!0);let r=await P({variables:{data:{min_order:Number(e.min_order),customer_type:M,discounted_value:Number(e.discounted_value),product_id:y}}});C(!1),I({min_order:"",customer_type:"",discounted_value:"",product_id:""}),D([...N,r.data.insert_product_discounts_one]),R(""),Q(),S(),l("➕ Added New Product Discount")}catch(e){console.log("Error ",e)}},Q=()=>{I({min_order:"",customer_type:"",discounted_value:"",product_id:""}),q(""),R("")};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.ZP,{open:r,anchor:"right",variant:"temporary",onClose:S,ModalProps:{keepMounted:!0},sx:{"& .MuiDrawer-paper":{width:{xs:300,sm:400}}},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between pli-5 plb-4",children:[t.jsx(h.Z,{variant:"h5",children:"Add Discount"}),t.jsx(o.Z,{size:"small",onClick:S,children:t.jsx("i",{className:"ri-close-line text-2xl"})})]}),t.jsx(i.Z,{}),t.jsx("div",{className:"p-5",children:(0,t.jsxs)("form",{onSubmit:E(e=>L(e)),className:"flex flex-col gap-5",children:[t.jsx(b.Qr,{name:"min_order",control:z,rules:{required:!0},render:({field:e})=>t.jsx(x.Z,{...e,fullWidth:!0,type:"number",label:"Minimal Order",placeholder:"",...O.min_order&&{error:!0,helperText:"This field is required."}})}),t.jsx(b.Qr,{name:"discounted_value",control:z,rules:{required:!0},render:({field:e})=>t.jsx(x.Z,{...e,fullWidth:!0,type:"number",label:"Discounted Value",placeholder:"",...O.discounted_value&&{error:!0,helperText:"This field is required."}})}),(0,t.jsxs)(d.Z,{fullWidth:!0,children:[t.jsx(c.Z,{children:"Select User Role"}),t.jsx(m.Z,{label:"Select Vendor",value:M||"",onChange:e=>R(e.target.value),children:F?.user_roles?.map((e,l)=>t.jsx(u.Z,{value:e?.role_name,children:e?.role_name},l))}),T&&t.jsx(Z.Z,{sx:{color:"red"},children:"Please select a user role."})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[t.jsx(a.Z,{variant:"contained",type:"submit",loading:w,children:"Add"}),t.jsx(a.Z,{variant:"outlined",color:"error",type:"reset",onClick:Q,children:"Discard"})]})]})})]}),t.jsx(g.Z,{})]})}},23656:(e,l,r)=>{r.d(l,{Z:()=>L});var t=r(27486),s=r(618),a=r(46811),i=r(12964),n=r(69121),d=r(51259),o=r(9594),c=r(2598),u=r(30785),m=r(72660),x=r(39800),h=r(44182),p=r(50822),g=r(23467),j=r(95727),_=r(20700),f=r(58894),v=r(83398),Z=r(45882),b=r(66718),S=r(91347),N=r(22405),y=r(25009),w=r(38532);let C=e=>{let{setGlobalMsg:l}=(0,N.q)(),{open:r,handleClose:a,discountData:n,loading:d,setLoading:c,setData:C}=e,[D]=(0,v.D)(b.dn),[P,M]=(0,s.useState)(),[R,F]=(0,s.useState)(),{data:k}=(0,Z.kJ)(y.pR),[q,T]=(0,s.useState)("");(0,s.useRef)(null);let{control:V,reset:z,handleSubmit:I,formState:{errors:E}}=(0,f.cI)({defaultValues:{min_order:"",discounted_value:"",customer_type:""}});(0,s.useEffect)(()=>{n&&(z({min_order:n.min_order,discounted_value:n.discounted_value,customer_type:n.customer_type}),F(n.customer_type))},[n,z]);let O=async e=>{try{c(!0);let r=await D({variables:{id:n.id,data:{min_order:Number(e.min_order),customer_type:R,discounted_value:Number(e.discounted_value),product_id:n.product_id}}});c(!1),C(e=>e.map(e=>e.id===n?.id?{...e,...r.data.update_product_discounts_by_pk}:e)),L(),l("✅ Product discount has been updated")}catch(e){console.log("Error ",e)}},L=()=>{a(),z({title:"",description:""}),T("")};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x.ZP,{open:r,anchor:"right",variant:"temporary",onClose:L,ModalProps:{keepMounted:!0},sx:{"& .MuiDrawer-paper":{width:{xs:300,sm:400}}},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between pli-5 plb-4",children:[t.jsx(m.Z,{variant:"h5",children:"Edit Discount"}),t.jsx(o.Z,{size:"small",onClick:L,children:t.jsx("i",{className:"ri-close-line text-2xl"})})]}),t.jsx(_.Z,{}),t.jsx("div",{className:"p-5",children:(0,t.jsxs)("form",{onSubmit:I(e=>O(e)),className:"flex flex-col gap-5",children:[t.jsx(f.Qr,{name:"min_order",control:V,rules:{required:!0},render:({field:e})=>t.jsx(u.Z,{...e,fullWidth:!0,type:"number",label:"Minimal Order",placeholder:"",...E.min_order&&{error:!0,helperText:"This field is required."}})}),t.jsx(f.Qr,{name:"discounted_value",control:V,rules:{required:!0},render:({field:e})=>t.jsx(u.Z,{...e,fullWidth:!0,type:"number",label:"Discounted Value",placeholder:"",...E.discounted_value&&{error:!0,helperText:"This field is required."}})}),R&&(0,t.jsxs)(h.Z,{fullWidth:!0,children:[t.jsx(p.Z,{children:"Select User Role"}),t.jsx(j.Z,{label:"Select Vendor",value:R,onChange:e=>F(e.target.value),children:k?.user_roles?.map((e,l)=>t.jsx(g.Z,{value:e?.role_name,children:e?.role_name},l))}),t.jsx(w.Z,{sx:{color:"red"},children:E?.role_name})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[t.jsx(i.Z,{variant:"contained",type:"submit",loading:d,children:"Update"}),t.jsx(i.Z,{variant:"outlined",color:"error",type:"reset",onClick:L,children:"Discard"})]})]})})]}),t.jsx(S.Z,{})]})};var D=r(61359),P=r(36514),M=r(57229),R=r(19396),F=r.n(R),k=r(5632),q=r(36839);r(81636),r(26808);var T=r(31538),V=r.n(T),z=r(88682);let I=(e,l,r,t)=>{let s=(0,D.O4)(e.getValue(l),r);return t({itemRank:s}),s.passed},E=({value:e,onChange:l,debounce:r=500,...a})=>{let[i,n]=(0,s.useState)(e);return(0,s.useEffect)(()=>{n(e)},[e]),(0,s.useEffect)(()=>{let e=setTimeout(()=>{l(i)},r);return()=>clearTimeout(e)},[i]),t.jsx(u.Z,{...a,value:i,onChange:e=>n(e.target.value),size:"small"})},O=(0,P.Cl)(),L=({discountDatas:e,productId:l})=>{let{data:r}=(0,Z.kJ)(y.DF),{setGlobalMsg:u}=(0,N.q)(),[x,h]=(0,s.useState)(""),[p,g]=(0,s.useState)(!1),[j,_]=(0,s.useState)({}),[f,w]=(0,s.useState)(e),[D,R]=(0,s.useState)(),[T,L]=(0,s.useState)(!1),[Q,W]=(0,s.useState)(f),[A,G]=(0,s.useState)(""),[H,J]=(0,s.useState)(!1),[U]=(0,v.D)(b.Qm),$=(e,l,r)=>({children:e,color:l,variant:r});(0,s.useEffect)(()=>{w(e)},[e]);let{lang:B}=(0,a.useParams)(),K=(0,s.useMemo)(()=>[O.accessor("id",{header:"#",cell:({row:e})=>t.jsx(m.Z,{color:"primary",children:`${e.original.id.substring(0,10)}`})}),O.accessor("min_order",{header:"Minimum Order",cell:({row:e})=>t.jsx("div",{className:"flex items-center gap-3",children:t.jsx("div",{className:"flex flex-col",children:t.jsx(m.Z,{className:"font-medium",color:"text.primary",children:e.original.min_order})})})}),O.accessor("customer_type",{header:"Customer Type",cell:({row:e})=>t.jsx("div",{className:"flex items-center gap-3",children:t.jsx("div",{className:"flex flex-col",children:t.jsx(m.Z,{className:"font-medium",color:"text.primary",children:e.original.customer_type})})})}),O.accessor("discounted_value",{header:"Discounted Value",cell:({row:e})=>t.jsx(m.Z,{children:`${null!==e.original.discounted_value?e.original?.discounted_value?.toLocaleString():"-"}`})}),O.accessor("created_at",{header:"Date",cell:({row:e})=>t.jsx(m.Z,{children:e.original?.created_at.substring(0,10)})}),O.accessor("action",{header:"Action",cell:({row:e})=>(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx(q.Z,{element:i.Z,elementProps:$(t.jsx("i",{className:"ri-delete-bin-7-line text-[22px] text-red-500"}),"error",""),dialog:k.Z,dialogProps:{type:"deleteProductDiscount"},dataId:e.original.id,setData:w,data:f}),t.jsx(o.Z,{onClick:()=>{R(e.original),J(!0)},children:t.jsx("i",{className:"ri-pencil-line"})})]}),enableSorting:!1})],[f,Q]),X=(0,M.b7)({data:Q,columns:K,filterFns:{fuzzy:I},state:{rowSelection:j,globalFilter:A},initialState:{pagination:{pageSize:10}},enableRowSelection:!0,globalFilterFn:I,onRowSelectionChange:_,getCoreRowModel:(0,P.sC)(),onGlobalFilterChange:G,getFilteredRowModel:(0,P.vL)(),getSortedRowModel:(0,P.tj)(),getPaginationRowModel:(0,P.G_)(),getFacetedRowModel:(0,P.o6)(),getFacetedUniqueValues:(0,P.JG)(),getFacetedMinMaxValues:(0,P.HO)()});return(0,s.useEffect)(()=>{W(f?.filter(e=>!x||e.status.toLowerCase().replace(/\s+/g,"-")===x))},[x,f,W]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.Z,{children:[t.jsx(d.Z,{className:"flex justify-between gap-4 flex-wrap flex-col sm:flex-row items-center",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row max-sm:is-full items-center  gap-4",children:[t.jsx(E,{value:A??"",onChange:e=>G(String(e)),placeholder:"Search Product Discount",className:"max-sm:is-full min-is-[200px]"}),t.jsx(i.Z,{variant:"contained",className:"max-sm:is-full is-auto",onClick:()=>L(!T),startIcon:t.jsx("i",{className:"ri-add-line"}),children:"Discount"})]})}),t.jsx("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:V().table,children:[t.jsx("thead",{children:X.getHeaderGroups().map(e=>t.jsx("tr",{children:e.headers.map(e=>t.jsx("th",{children:e.isPlaceholder?null:t.jsx(t.Fragment,{children:(0,t.jsxs)("div",{className:F()({"flex items-center":e.column.getIsSorted(),"cursor-pointer select-none":e.column.getCanSort()}),onClick:e.column.getToggleSortingHandler(),children:[(0,M.ie)(e.column.columnDef.header,e.getContext()),{asc:t.jsx("i",{className:"ri-arrow-up-s-line text-xl"}),desc:t.jsx("i",{className:"ri-arrow-down-s-line text-xl"})}[e.column.getIsSorted()]??null]})})},e.id))},e.id))}),0===X.getFilteredRowModel().rows.length?t.jsx("tbody",{children:t.jsx("tr",{children:t.jsx("td",{colSpan:X.getVisibleFlatColumns().length,className:"text-center",children:"No data available"})})}):t.jsx("tbody",{children:X.getRowModel().rows.slice(0,X.getState().pagination.pageSize).map(e=>t.jsx("tr",{className:F()({selected:e.getIsSelected()}),children:e.getVisibleCells().map(e=>t.jsx("td",{children:(0,M.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id))})]})}),t.jsx(c.Z,{rowsPerPageOptions:[10,25,50],component:"div",className:"border-bs",count:X.getFilteredRowModel().rows.length,rowsPerPage:X.getState().pagination.pageSize,page:X.getState().pagination.pageIndex,SelectProps:{inputProps:{"aria-label":"rows per page"}},onPageChange:(e,l)=>{X.setPageIndex(l)},onRowsPerPageChange:e=>X.setPageSize(Number(e.target.value))})]}),t.jsx(S.Z,{}),t.jsx(z.Z,{open:T,productId:l,data:f,setData:w,loading:p,setLoading:g,handleClose:()=>L(!T)}),t.jsx(C,{open:H,discountData:D,setData:w,loading:p,setLoading:g,handleClose:()=>J(!H)})]})}}};