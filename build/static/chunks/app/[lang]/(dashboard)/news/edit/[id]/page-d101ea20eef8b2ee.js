(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9270],{54030:function(e,i,t){Promise.resolve().then(t.bind(t,10189))},10189:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return G}});var l=t(59533),s=t(91771),n=t(12895),r=t(76422),a=t(29349),c=t(31029),d=t(20397),o=t(45641),u=t(40877),x=t(66873),h=t(29900),m=t(84323),g=e=>{let{handleDiscardProduct:i,handleEditNews:t}=e;return(0,l.jsxs)("div",{className:"flex flex-wrap sm:items-center justify-between max-sm:flex-col gap-6",children:[(0,l.jsx)("div",{children:(0,l.jsx)(m.Z,{variant:"h4",className:"mbe-1",children:"Edit a new Post"})}),(0,l.jsxs)("div",{className:"flex flex-wrap max-sm:flex-col gap-4",children:[(0,l.jsx)(h.Z,{variant:"outlined",color:"error",onClick:i,children:"Cancel"}),(0,l.jsx)(h.Z,{variant:"contained",onClick:t,children:"Update"})]})]})},v=t(31229),j=t(76778),p=t(11124),f=t(54323),Z=t(84448),y=t(71491),b=t(87616),w=t(73815),_=t(62934);t(83762);var N=t(6083),k=t(70337);let A=(0,w.ZP)(k.Z)(e=>{let{theme:i}=e;return{"& .dropzone":{minHeight:"unset",padding:i.spacing(12),[i.breakpoints.down("sm")]:{paddingInline:i.spacing(5)},"&+.MuiList-root .MuiListItem-root .file-name":{fontWeight:i.typography.body1.fontWeight}}}});var C=e=>{let i,{files:t,setFiles:s,newData:n,isImageChange:r,setIsImageChange:a}=e,[c,d]=(0,v.useState)(""),{getRootProps:o,getInputProps:u}=(0,_.uI)({multiple:!1,onDrop:e=>{a(!0);let i=e.filter(e=>e.type.startsWith("image"));i.length!==e.length?d("Only image files are allowed."):d(""),s(i.map(e=>Object.assign(e)))}}),x=()=>{s([]),a(!1)};return(0,l.jsx)(A,{children:(0,l.jsxs)(j.Z,{children:[(0,l.jsx)(p.Z,{title:"Product Image",sx:{"& .MuiCardHeader-action":{alignSelf:"center"}}}),(0,l.jsxs)(f.Z,{children:[(0,l.jsxs)("div",{...o({className:"dropzone"}),children:[(0,l.jsx)("input",{...u()}),(0,l.jsxs)("div",{className:"flex items-center flex-col gap-2 text-center",children:[(0,l.jsx)(N.default,{variant:"rounded",skin:"light",color:"secondary",children:(0,l.jsx)("i",{className:"ri-upload-2-line"})}),(0,l.jsx)(m.Z,{variant:"h4",children:"Drag and Drop Your Image Here."}),(0,l.jsx)(m.Z,{color:"text.disabled",children:"or"}),(0,l.jsx)(h.Z,{variant:"outlined",size:"small",children:"Browse Image"})]})]}),c&&(0,l.jsx)(m.Z,{color:"error",variant:"body2",children:c}),(0,l.jsx)(y.Z,{children:(0,l.jsxs)(b.ZP,{className:"pis-4 plb-3",children:[(0,l.jsx)("div",{className:"file-details",children:(0,l.jsx)("div",{className:"file-preview",children:(i=t.length>0?t[0]:null,r&&i instanceof File?(0,l.jsx)("img",{width:38,height:38,alt:i.name,src:URL.createObjectURL(i)}):(null==n?void 0:n.image_url)?(0,l.jsx)("img",{width:38,height:38,alt:"image",src:n.image_url}):(0,l.jsx)(m.Z,{children:"No image available"}))})}),t.length>0&&(0,l.jsx)(Z.Z,{onClick:()=>x(t[0]),children:(0,l.jsx)("i",{className:"ri-close-line text-xl"})})]})}),(0,l.jsx)("div",{className:"buttons",children:(0,l.jsx)(h.Z,{color:"error",variant:"outlined",onClick:()=>{s([]),a(!1)},children:"Remove All"})})]})]})})},P=t(48111),S=t(61732),I=t(72860),E=t.n(I),z=t(9772),D=t(41238),L=t(36706),T=t(40729),U=t(16798),O=t(18308);t(82156);let q=e=>{let{editor:i}=e;return i?(0,l.jsxs)("div",{className:"flex flex-wrap gap-x-3 gap-y-1 pbs-5 pbe-4 pli-5",children:[(0,l.jsx)(O.Z,{...i.isActive("bold")&&{color:"primary"},variant:"outlined",size:"small",onClick:()=>i.chain().focus().toggleBold().run(),children:(0,l.jsx)("i",{className:E()("ri-bold",{"text-textSecondary":!i.isActive("bold")})})}),(0,l.jsx)(O.Z,{...i.isActive("underline")&&{color:"primary"},variant:"outlined",size:"small",onClick:()=>i.chain().focus().toggleUnderline().run(),children:(0,l.jsx)("i",{className:E()("ri-underline",{"text-textSecondary":!i.isActive("underline")})})}),(0,l.jsx)(O.Z,{...i.isActive("italic")&&{color:"primary"},variant:"outlined",size:"small",onClick:()=>i.chain().focus().toggleItalic().run(),children:(0,l.jsx)("i",{className:E()("ri-italic",{"text-textSecondary":!i.isActive("italic")})})}),(0,l.jsx)(O.Z,{...i.isActive("strike")&&{color:"primary"},variant:"outlined",size:"small",onClick:()=>i.chain().focus().toggleStrike().run(),children:(0,l.jsx)("i",{className:E()("ri-strikethrough",{"text-textSecondary":!i.isActive("strike")})})}),(0,l.jsx)(O.Z,{...i.isActive("bulletList")&&{color:"primary"},variant:"outlined",size:"small",onClick:()=>i.chain().focus().toggleBulletList().run(),children:(0,l.jsx)("i",{className:E()("ri-list-unordered",{"text-textSecondary":!i.isActive("bulletList")})})}),(0,l.jsx)(O.Z,{...i.isActive({textAlign:"left"})&&{color:"primary"},variant:"outlined",size:"small",onClick:()=>i.chain().focus().setTextAlign("left").run(),children:(0,l.jsx)("i",{className:E()("ri-align-left",{"text-textSecondary":!i.isActive({textAlign:"left"})})})}),(0,l.jsx)(O.Z,{...i.isActive({textAlign:"center"})&&{color:"primary"},variant:"outlined",size:"small",onClick:()=>i.chain().focus().setTextAlign("center").run(),children:(0,l.jsx)("i",{className:E()("ri-align-center",{"text-textSecondary":!i.isActive({textAlign:"center"})})})}),(0,l.jsx)(O.Z,{...i.isActive({textAlign:"right"})&&{color:"primary"},variant:"outlined",size:"small",onClick:()=>i.chain().focus().setTextAlign("right").run(),children:(0,l.jsx)("i",{className:E()("ri-align-right",{"text-textSecondary":!i.isActive({textAlign:"right"})})})}),(0,l.jsx)(O.Z,{...i.isActive({textAlign:"justify"})&&{color:"primary"},variant:"outlined",size:"small",onClick:()=>i.chain().focus().setTextAlign("justify").run(),children:(0,l.jsx)("i",{className:E()("ri-align-justify",{"text-textSecondary":!i.isActive({textAlign:"justify"})})})})]}):null};var H=e=>{let{setTitle:i,title:t,setDescription:n,description:r,errors:a}=e,c=(0,z.jE)({extensions:[D.V,T.V.configure({placeholder:"Write something here..."}),U.P.configure({types:["heading","paragraph"]}),L.v],content:r,onUpdate:e=>{let{editor:i}=e;n(i.getHTML())}});return(0,v.useEffect)(()=>{c&&r!==c.getHTML()&&c.commands.setContent(r||"")},[r,c]),(0,l.jsxs)(j.Z,{children:[(0,l.jsx)(p.Z,{title:"Post Information"}),(0,l.jsxs)(f.Z,{children:[(0,l.jsx)(s.ZP,{container:!0,spacing:5,className:"mbe-5",children:(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(S.Z,{fullWidth:!0,label:"Post Name",placeholder:"Enter Post Name",value:t,onChange:e=>i(e.target.value),error:null!=a&&!!a.title,helperText:null==a?void 0:a.title})})}),(0,l.jsx)(m.Z,{className:"mbe-1",children:"Description"}),(0,l.jsx)(j.Z,{className:"p-0 border shadow-none",children:(0,l.jsxs)(f.Z,{className:"p-0",children:[(0,l.jsx)(q,{editor:c}),(0,l.jsx)(P.Z,{className:"mli-5"}),(0,l.jsx)(z.kg,{editor:c,className:"bs-[135px] overflow-y-auto flex ",onChange:e=>n(e.target.value)})]})})]})]})},R=t(83379),W=t(60753),M=t(6532),F=t(37911),J=t(10696),B=t(5176),V=t(64094),X=e=>{var i,t;let{productId:s,setProductId:n,catId:r,setCatId:a,errors:d,newData:o}=e,{data:x}=(0,u.kJ)(c.yf),{data:h}=(0,u.kJ)(c.XR),{data:m}=(0,u.kJ)(c.wC,{variables:{news_id:null==o?void 0:o.id}});return(0,v.useEffect)(()=>{if(o){var e,i;a(null===(e=o.news_category)||void 0===e?void 0:e.id),n(m&&(null==m?void 0:null===(i=m.news_related_products)||void 0===i?void 0:i.map(e=>null==e?void 0:e.product_id)))}},[o,a,n]),(0,l.jsxs)(j.Z,{children:[(0,l.jsx)(p.Z,{title:"Organize"}),(0,l.jsx)(f.Z,{children:(0,l.jsxs)("form",{onSubmit:e=>e.preventDefault(),className:"flex flex-col gap-5",children:[r&&(0,l.jsxs)(R.Z,{fullWidth:!0,children:[(0,l.jsx)(W.Z,{children:"Select News Category"}),(0,l.jsx)(F.Z,{label:"Select Category",value:r,onChange:e=>a(e.target.value),error:null==d?void 0:d.catId,children:null==x?void 0:null===(i=x.news_categories)||void 0===i?void 0:i.map((e,i)=>(0,l.jsx)(M.Z,{value:null==e?void 0:e.id,children:null==e?void 0:e.title},i))}),(0,l.jsx)(V.Z,{sx:{color:"red"},children:null==d?void 0:d.catId})]}),(0,l.jsx)(B.Z,{multiple:!0,value:(null==h?void 0:null===(t=h.products)||void 0===t?void 0:t.filter(e=>s.includes(e.id)))||[],onChange:(e,i)=>{n(i.map(e=>e.id))},className:"overflow-y-auto h-[40vh]",id:"checkboxes-tags-demo",options:(null==h?void 0:h.products)||[],disableCloseOnSelect:!0,getOptionLabel:e=>(null==e?void 0:e.title)||"",renderOption:(e,i,t)=>{let{selected:s}=t;return(0,v.createElement)("li",{...e,key:i.id,children:[(0,l.jsx)(J.Z,{style:{marginRight:8},checked:s}),i.title]})},renderInput:e=>(0,l.jsx)(S.Z,{...e,label:"Products",placeholder:"select products"})})]})})]})},Y=t(61250),G=()=>{let{id:e}=(0,Y.useParams)(),i=(0,Y.useRouter)(),{setGlobalMsg:t,loading:h,setLoading:m}=(0,n.q)(),[j,p]=(0,v.useState)(),[f,Z]=(0,v.useState)(),[y,b]=(0,v.useState)(),[w,_]=(0,v.useState)([]),[N,k]=(0,v.useState)([]),[A,P]=(0,v.useState)(),[S,I]=(0,v.useState)(!1),[E]=(0,o.D)(a.dE),[z]=(0,o.D)(a.Hd),[D]=(0,o.D)(a.Sf),{data:L}=(0,u.kJ)(c.Ev,{variables:{id:e}}),T=L.news_by_pk,[U]=(0,o.D)(a.yn);(0,v.useEffect)(()=>{T&&(_(T.image_url),p(T.title),Z(T.body_html))},[T]);let O=async()=>{m(!0);let e={},l=!1;if(j||(e.title="Title field is required",l=!0),y||(e.catId="Category field is required",l=!0),N||(e.productId="Product field is required",l=!0),l){P({...e}),m(!1);return}try{let e=T.image_url;if(w&&w!==(null==T?void 0:T.image_url)){let{data:i}=await D({variables:{content_type:"image",folder:"products"}});e=await (0,d.c)(w[0],i.getFileUploadUrl.fileUploadUrl,"image")}let l=await E({variables:{id:T.id,data:{title:j,body_html:f,news_category_id:y,image_url:w!==T.image_url?e:T.image_url}}});await U({variables:{news_id:l.data.update_news_by_pk.id}}),N.map(async e=>{var i;return await z({variables:{data:{news_id:null==l?void 0:null===(i=l.data)||void 0===i?void 0:i.update_news_by_pk.id,product_id:e.id?e.id:e}}})}),i.back(),m(!1),p(""),Z(""),k([]),b(""),t("✅ New post has been updated")}catch(e){t("❌ Add News Error"),console.log(e.response)}};return h?(0,l.jsx)(x.Z,{sx:{textAlign:"center"},children:"Loading..."}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(s.ZP,{container:!0,spacing:6,children:[(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(g,{handleDiscardProduct:()=>{i.back()},handleEditNews:O})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,md:8,children:(0,l.jsxs)(s.ZP,{container:!0,spacing:6,children:[(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(H,{setTitle:p,title:j,setDescription:Z,description:f,errors:A})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(C,{files:w,setFiles:_,newData:T,isImageChange:S,setIsImageChange:I})})]})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,md:4,children:(0,l.jsx)(s.ZP,{container:!0,spacing:6,children:(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(X,{catId:y,setCatId:b,productId:N,setProductId:k,errors:A,newData:T})})})})]}),(0,l.jsx)(r.Z,{})]})}},20397:function(e,i,t){"use strict";t.d(i,{Z:function(){return o},c:function(){return d}});let l=["/en/dashboards","/en/products","/en/user","/en/orders","/en/news","/en/services","/en/service_token","/en/invoice","/en/quotations","/en/admin","/en/service_center","/en/ewarranties"],s=["/en/dashboards","/en/products","/en/services","/en/service_center","/en/news"],n=["/en/dashboards","/en/orders","/en/invoice","/en/quotations"],r=["/en/dashboards","/en/services","/en/service_token","/en/invoice"],a=["/en/dashboards","/en/orders"],c=["/en/dashboards","/en/orders","/en/invoice"],d=async(e,i,t)=>{try{return(await fetch(i,{method:"PUT",headers:{"Content-Type":"".concat(t,"/*"),"x-amz-acl":"public-read"},body:e})).url.split("?")[0]}catch(e){throw alert(e),console.log(e),Error(e)}},o=(e,i)=>!!("admin"===e&&l.includes("/en/"+i)||"manager"===e&&s.includes("/en/"+i)||"service"===e&&r.includes("/en/"+i)||"sale"===e&&n.includes("/en/"+i))||!!("delivery"===e&&a.includes("/en/"+i))||!!("finance"===e&&c.includes("/en/"+i))}},function(e){e.O(0,[5392,7382,9423,6086,5278,6353,1378,8190,5266,1802,1732,6479,9276,9124,1166,1771,3302,3347,1711,6772,1467,1668,5176,8725,8503,4170,6842,1744],function(){return e(e.s=54030)}),_N_E=e.O()}]);