(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[844],{84087:function(e,r,l){Promise.resolve().then(l.bind(l,73653))},80824:function(e,r,l){"use strict";var i=l(22988),n=l(23950),s=l(2265),t=l(44839),a=l(76990),o=l(83719),d=l(48024),c=l(95885),u=l(23849),x=l(1348),m=l(57437);let h=["className","id"],v=e=>{let{classes:r}=e;return(0,a.Z)({root:["root"]},u.a,r)},j=(0,d.ZP)(o.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,r)=>r.root})({padding:"16px 24px",flex:"0 0 auto"}),p=s.forwardRef(function(e,r){let l=(0,c.i)({props:e,name:"MuiDialogTitle"}),{className:a,id:o}=l,d=(0,n.Z)(l,h),u=v(l),{titleId:p=o}=s.useContext(x.Z);return(0,m.jsx)(j,(0,i.Z)({component:"h2",className:(0,t.Z)(u.root,a),ownerState:l,ref:r,variant:"h6",id:null!=o?o:p},d))});r.Z=p},47380:function(e,r,l){"use strict";var i=l(57437);l(2265);var n=l(3550),s=l(9188);r.Z=()=>{let{globalMsg:e,setGlobalMsg:r}=(0,s.q)();return(0,i.jsx)("div",{children:(0,i.jsx)(n.Z,{anchorOrigin:{horizontal:"center",vertical:"top"},open:!!e,autoHideDuration:3e3,onClose:()=>r(null),message:e})})}},73317:function(e,r,l){"use strict";l.d(r,{Q:function(){return i}});let i=e=>e.split(/\s/).reduce((e,r)=>e+=r.slice(0,1),"")},90307:function(e,r,l){"use strict";l.d(r,{Z:function(){return c},c:function(){return d}});let i=["/en/dashboards","/en/products","/en/user","/en/orders","/en/news","/en/services","/en/service_token","/en/invoice","/en/quotations","/en/admin","/en/service_center"],n=["/en/dashboards","/en/products","/en/services","/en/service_center","/en/news"],s=["/en/dashboards","/en/orders","/en/invoice","/en/quotations"],t=["/en/dashboards","/en/services","/en/service_token","/en/invoice"],a=["/en/dashboards","/en/orders"],o=["/en/dashboards","/en/orders","/en/invoice"],d=async(e,r,l)=>{try{return(await fetch(r,{method:"PUT",headers:{"Content-Type":"".concat(l,"/*"),"x-amz-acl":"public-read"},body:e})).url.split("?")[0]}catch(e){throw alert(e),console.log(e),Error(e)}},c=(e,r)=>!!("admin"===e&&i.includes("/en/"+r)||"manager"===e&&n.includes("/en/"+r)||"service"===e&&t.includes("/en/"+r)||"sale"===e&&s.includes("/en/"+r))||!!("delivery"===e&&a.includes("/en/"+r))||!!("finance"===e&&o.includes("/en/"+r))},73653:function(e,r,l){"use strict";l.d(r,{default:function(){return Y}});var i=l(57437),n=l(33037),s=l(15667),t=l(57683),a=l(83719);l(6830),l(47868);var o=l(23944),d=l(44514),c=l(1552),u=l(2265),x=l(47380),m=l(9188),h=l(61096),v=l(80824),j=l(66124),p=l(48965),g=l(98784),f=l(90307);let Z={completed:"success",canceled:"error",refunded:"warning",delivering:"primary",preparing:"info",ordered:"secondary"};var b=e=>{var r;let{orderData:l}=e,{setGlobalMsg:n}=(0,m.q)(),[b,y]=(0,u.useState)(!1),[N]=(0,o.D)(c.HT),[w]=(0,o.D)(c.tt,{refetchQueries:[d.Nz]}),[_]=(0,o.D)(c.mt),[C]=(0,o.D)(c.Sf),[S,D]=(0,u.useState)();(0,u.useRef)(null);let P=async(e,r)=>{try{await w({variables:{order_id:e,status:r}}),n("Change Order Status")}catch(e){console.log("Change Status Error ",e)}};return(0,i.jsxs)("div",{className:"flex flex-wrap justify-between sm:items-center max-sm:flex-col gap-y-4",children:[(0,i.jsxs)("div",{className:"flex flex-col items-start gap-1",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(a.Z,{variant:"h5",children:"Order - ".concat(null==l?void 0:l.order_number)}),(0,i.jsx)(t.Z,{variant:"tonal",label:null==l?void 0:l.status,color:Z[(null==l?void 0:l.status)||""],size:"small"})]}),(0,i.jsx)(a.Z,{children:"".concat(new Date(null!==(r=null==l?void 0:l.ordered_at)&&void 0!==r?r:"").toLocaleString())})]}),(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsx)(s.Z,{color:"error",variant:"outlined",onClick:()=>y(!0),children:"Complete"}),(0,i.jsx)(s.Z,{variant:"outlined",color:"error",onClick:()=>P(l.id,"canceled"),children:"Cancel"}),(0,i.jsx)(s.Z,{variant:"outlined",color:"primary",onClick:()=>P(l.id,"delivering"),children:"Delivering"}),(0,i.jsx)(s.Z,{variant:"outlined",color:"info",onClick:()=>P(l.id,"preparing"),children:"Preparing"})]}),(0,i.jsx)("div",{children:(0,i.jsxs)(h.Z,{fullWidth:"md",open:b,onClose:()=>y(!1),PaperProps:{component:"form",onSubmit:async e=>{e.preventDefault();let r=Object.fromEntries(new FormData(e.currentTarget).entries()),i=null==r?void 0:r.remark,s=null==r?void 0:r.image,t=await C({variables:{content_type:"image",folder:"products"}}),a=await (0,f.c)(s,t.data.getFileUploadUrl.fileUploadUrl,"image");await _({variables:{completion_photo_url:a,id:null==l?void 0:l.id,remark:i}}),await P(null==l?void 0:l.id,"completed"),n("âœ… Image Send Successfull"),y(!1)}},children:[(0,i.jsx)(v.Z,{children:"Order Complete"}),(0,i.jsxs)(j.Z,{children:[(0,i.jsx)(p.Z,{multiline:!0,autoFocus:!0,margin:"dense",id:"remark",name:"remark",label:"Remark",fullWidth:!0,variant:"standard"}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)(p.Z,{type:"file",autoFocus:!0,margin:"dense",id:"image",name:"image",alt:"image",fullWidth:!0,variant:"standard"})]}),(0,i.jsxs)(g.Z,{children:[(0,i.jsx)(s.Z,{color:"error",onClick:()=>y(!1),children:"Cancel"}),(0,i.jsx)(s.Z,{color:"success",type:"submit",children:"OK"})]})]})}),(0,i.jsx)(x.Z,{})]})},y=l(76520),N=l(20248),w=l(55205),_=l(56800),C=l.n(_),S=l(13541),D=l(54175),P=l(33514);l(31155);var k=l(18156),R=l.n(k);let M=(e,r,l,i)=>{let n=(0,S.O4)(e.getValue(r),l);return i({itemRank:n}),n.passed},O=(0,D.Cl)(),F=e=>{var r;let{orderData:l}=e,[n,s]=(0,u.useState)({}),[t,o]=(0,u.useState)(l.order_items),[d,c]=(0,u.useState)(""),x=(0,u.useMemo)(()=>[O.accessor("title",{header:"Product",cell:e=>{var r,l,n,s;let{row:t}=e;return(0,i.jsx)("div",{className:"flex items-center gap-3 text-wrap",children:(0,i.jsxs)("div",{className:"flex flex-col items-start  ",children:[(0,i.jsx)(a.Z,{color:"text.primary",className:"font-medium w-60 text-wrap",children:null===(l=t.original)||void 0===l?void 0:null===(r=l.product)||void 0===r?void 0:r.title}),(0,i.jsx)(a.Z,{variant:"body2",children:null===(s=t.original)||void 0===s?void 0:null===(n=s.product.brand)||void 0===n?void 0:n.title})]})})}}),O.accessor("order_items?.unit_price",{header:"Price",cell:e=>{var r,l;let{row:n}=e;return(0,i.jsxs)(a.Z,{children:["".concat(null===(l=n.original)||void 0===l?void 0:null===(r=l.unit_price)||void 0===r?void 0:r.toLocaleString())," Ks"]})}}),O.accessor("quantity",{header:"Qty",cell:e=>{var r;let{row:l}=e;return(0,i.jsx)(a.Z,{children:"".concat(null===(r=l.original)||void 0===r?void 0:r.quantity)})}}),O.accessor("total",{header:"Total",cell:e=>{var r;let{row:l}=e;return(0,i.jsxs)(a.Z,{children:["".concat(null===(r=l.original.total)||void 0===r?void 0:r.toLocaleString())," Ks"]})}})],[]),m=(0,P.b7)({data:t,columns:x,filterFns:{fuzzy:M},state:{rowSelection:n,globalFilter:d},initialState:{pagination:{pageSize:10}},enableRowSelection:!0,globalFilterFn:M,onRowSelectionChange:s,getCoreRowModel:(0,D.sC)(),onGlobalFilterChange:c,getFilteredRowModel:(0,D.vL)(),getSortedRowModel:(0,D.tj)(),getPaginationRowModel:(0,D.G_)(),getFacetedRowModel:(0,D.o6)(),getFacetedUniqueValues:(0,D.JG)(),getFacetedMinMaxValues:(0,D.HO)()});return(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)("table",{className:R().table,children:[(0,i.jsx)("thead",{children:m.getHeaderGroups().map(e=>(0,i.jsx)("tr",{children:e.headers.map(e=>{var r;return(0,i.jsx)("th",{children:e.isPlaceholder?null:(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:C()({"flex items-center":e.column.getIsSorted(),"cursor-pointer select-none":e.column.getCanSort()}),onClick:e.column.getToggleSortingHandler(),children:[(0,P.ie)(e.column.columnDef.header,e.getContext()),null!==(r=({asc:(0,i.jsx)("i",{className:"ri-arrow-up-s-line text-xl"}),desc:(0,i.jsx)("i",{className:"ri-arrow-down-s-line text-xl"})})[e.column.getIsSorted()])&&void 0!==r?r:null]})})},e.id)})},e.id))}),(null===(r=m.getFilteredRowModel().rows)||void 0===r?void 0:r.length)===0?(0,i.jsx)("tbody",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:m.getVisibleFlatColumns().length,className:"text-center",children:"No data available"})})}):(0,i.jsx)("tbody",{className:"border-be",children:m.getRowModel().rows.slice(0,m.getState().pagination.pageSize).map(e=>(0,i.jsx)("tr",{className:C()({selected:e.getIsSelected()}),children:e.getVisibleCells().map(e=>(0,i.jsx)("td",{className:"first:is-14",children:(0,P.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id))})]})})};var T=e=>{var r,l;let{orderData:n}=e;return(0,i.jsxs)(y.Z,{children:[(0,i.jsx)(N.Z,{title:"Order Details"}),(0,i.jsx)(F,{orderData:n}),(0,i.jsx)(w.Z,{className:"flex justify-end",children:(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center gap-12",children:[(0,i.jsx)(a.Z,{color:"text.primary",className:"min-is-[100px]",children:"Subtotal:"}),(0,i.jsxs)(a.Z,{color:"text.primary",className:"font-medium",children:[null==n?void 0:null===(r=n.items_total)||void 0===r?void 0:r.toLocaleString()," Ks"]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-12",children:[(0,i.jsx)(a.Z,{color:"text.primary",className:"font-medium min-is-[100px]",children:"Total:"}),(0,i.jsxs)(a.Z,{color:"text.primary",className:"font-medium",children:[null==n?void 0:null===(l=n.total)||void 0===l?void 0:l.toLocaleString()," Ks"]})]})]})})]})},L=l(99295),z=l(32914),q=l(2397),I=l(26428),E=l(44711),U=l(48024),H=l(2645);let K=(0,U.ZP)(H.Z)({paddingLeft:0,paddingRight:0,"& .MuiTimelineItem-root":{width:"100%","&:before":{display:"none"},"& .MuiTimelineContent-root:last-child":{paddingBottom:0},"&:nth-last-child(2) .MuiTimelineConnector-root":{backgroundColor:"transparent",borderInlineStart:"1px dashed var(--mui-palette-divider)"},"& .MuiTimelineConnector-root":{backgroundColor:"var(--mui-palette-primary-main)"}}});var V=e=>{let{orderData:r}=e;return(0,i.jsxs)(y.Z,{children:[(0,i.jsx)(N.Z,{title:"Delivery Activity"}),(0,i.jsx)(w.Z,{children:(0,i.jsxs)(K,{children:[(0,i.jsxs)(z.Z,{children:[(0,i.jsxs)(I.Z,{children:[(0,i.jsx)(L.Z,{color:"primary"}),(0,i.jsx)(E.Z,{})]}),(0,i.jsxs)(q.Z,{children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-x-2 mbe-2.5",children:[(0,i.jsxs)(a.Z,{color:"text.primary",className:"font-medium",children:["Order was placed (Order ID: #",null==r?void 0:r.order_number,")"]}),(0,i.jsx)(a.Z,{variant:"caption",children:new Date(r.ordered_at).toLocaleString()})]}),(0,i.jsx)(a.Z,{className:"mbe-2",children:"Order has been placed successfully"})]})]}),(0,i.jsxs)(z.Z,{children:[(0,i.jsxs)(I.Z,{children:[(0,i.jsx)(L.Z,{color:(null==r?void 0:r.preparing_at)===null?"grey":"primary"}),(0,i.jsx)(E.Z,{})]}),(0,i.jsxs)(q.Z,{children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-x-2 mbe-2.5",children:[(0,i.jsx)(a.Z,{color:"text.primary",className:"font-medium",children:"Preparing"}),(null==r?void 0:r.preparing_at)!==null&&(0,i.jsx)(a.Z,{variant:"caption",children:new Date(null==r?void 0:r.preparing_at).toLocaleString()})]}),(0,i.jsx)(a.Z,{className:"mbe-2",children:"Order is preparing"})]})]}),(0,i.jsxs)(z.Z,{children:[(0,i.jsxs)(I.Z,{children:[(0,i.jsx)(L.Z,{color:(null==r?void 0:r.delivering_at)===null?"grey":"primary"}),(0,i.jsx)(E.Z,{})]}),(0,i.jsxs)(q.Z,{children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-x-2 mbe-2.5",children:[(0,i.jsx)(a.Z,{color:"text.primary",className:"font-medium",children:"Delivering"}),(null==r?void 0:r.delivering_at)!==null&&(0,i.jsx)(a.Z,{variant:"caption",children:new Date(null==r?void 0:r.delivering_at).toLocaleString()})]}),(0,i.jsx)(a.Z,{className:"mbe-2",children:"Order is delivering "})]})]}),(0,i.jsxs)(z.Z,{children:[(0,i.jsxs)(I.Z,{children:[(0,i.jsx)(L.Z,{color:(null==r?void 0:r.completed_at)===null?"grey":"primary"}),(0,i.jsx)(E.Z,{})]}),(0,i.jsxs)(q.Z,{children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-x-2 mbe-2.5",children:[(0,i.jsx)(a.Z,{color:"text.primary",className:"font-medium",children:"Completed"}),(null==r?void 0:r.completed_at)!==null&&(0,i.jsx)(a.Z,{variant:"caption",children:new Date(null==r?void 0:r.completed_at).toLocaleString()})]}),(0,i.jsx)(a.Z,{className:"mbe-2",children:"Order has been completed "})]})]})]})})]})},G=l(96303);l(49758),l(30812);var Q=l(73317);let A=e=>{let{avatar:r,customer:l}=e;return r?(0,i.jsx)(G.Z,{src:r}):(0,i.jsx)(G.Z,{children:(0,Q.Q)(l)})};var W=e=>{var r,l;let{orderData:n}=e;return(0,i.jsx)(y.Z,{children:(0,i.jsxs)(w.Z,{className:"flex flex-col gap-6",children:[(0,i.jsx)(a.Z,{variant:"h5",children:"Customer details"}),(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[A({avatar:null!==(r=null==n?void 0:n.avatar)&&void 0!==r?r:"",customer:null!==(l=null==n?void 0:n.user.profile_picture_url)&&void 0!==l?l:""}),(0,i.jsx)("div",{className:"flex flex-col",children:(0,i.jsx)(a.Z,{color:"text.primary",className:"font-medium",children:null==n?void 0:n.user.name})})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsx)("div",{className:"flex justify-between items-center",children:(0,i.jsx)(a.Z,{color:"text.primary",className:"font-medium",children:"Contact info"})}),(0,i.jsxs)(a.Z,{children:["Mobile : ",n.user.phone]})]})]})})};l(54984);var J=e=>{let{orderData:r}=e;return(0,i.jsx)(y.Z,{children:(0,i.jsxs)(w.Z,{className:"flex flex-col gap-6",children:[(0,i.jsx)("div",{className:"flex justify-between items-center",children:(0,i.jsx)(a.Z,{variant:"h5",children:"Delivery Address"})}),(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsxs)(a.Z,{children:["Receiver Name : ",null==r?void 0:r.receiver_name]}),(0,i.jsx)("br",{}),(0,i.jsxs)(a.Z,{children:["Receiver Phone : ",null==r?void 0:r.receiver_phone]}),(0,i.jsx)("br",{}),(0,i.jsxs)(a.Z,{children:["Receiver Address : ",null==r?void 0:r.receiver_address]})]})]})})},B=l(16463),X=l(43808),Y=()=>{let{id:e}=(0,B.useParams)(),{data:r}=(0,X.kJ)(d.Nz,{variables:{id:e}}),l=null==r?void 0:r.orders_by_pk;return(0,i.jsxs)(n.ZP,{container:!0,spacing:6,children:[(0,i.jsx)(n.ZP,{item:!0,xs:12,children:(0,i.jsx)(b,{orderData:l})}),(0,i.jsx)(n.ZP,{item:!0,xs:12,md:8,children:(0,i.jsxs)(n.ZP,{container:!0,spacing:6,children:[(0,i.jsx)(n.ZP,{item:!0,xs:12,children:(0,i.jsx)(T,{orderData:l})}),(0,i.jsx)(n.ZP,{item:!0,xs:12,children:(0,i.jsx)(V,{orderData:l})})]})}),(0,i.jsx)(n.ZP,{item:!0,xs:12,md:4,children:(0,i.jsxs)(n.ZP,{container:!0,spacing:6,children:[(0,i.jsx)(n.ZP,{item:!0,xs:12,children:(0,i.jsx)(W,{orderData:l})}),(0,i.jsx)(n.ZP,{item:!0,xs:12,children:(0,i.jsx)(J,{orderData:l})})]})})]})}}},function(e){e.O(0,[956,1441,9584,7138,9855,8329,7660,7800,8965,6805,6101,7212,5313,481,7172,4175,3550,7683,779,887,468,2869,4514,1552,7519,2971,7023,1744],function(){return e(e.s=84087)}),_N_E=e.O()}]);